# MySQL 서버 업그레이드

MySQL 서버를 업그레이드하는 방법으로는 첫 번째로 MySQL 서버의 데이터 파일을 그대로 두고 업그레이드하는 방법과 두 번째로 mysqldump 도구 등을 이용해 MySQL 서버의 데이터를 SQL 문장이나 텍스트 파일로 덤프한 후, 새로 업그레이드된 버전의 MySQL 서버에서 덤프된 데이터를 적재하는 방법이 있다.  
첫 번째 방법을 '인플레이스 업그레이드'라고 하며, 두 번째를 '논리적 업그레이드'라고 한다.  

<br/>

## 인플레이스 업그레이드 제약 사항

업그레이드는 마이너 버전 간 업그레이드와 메이저 버전 간 업그레이드를 생각해볼 수 있다. 동일 메이저 버전에서 마이너 버전 간 업그레이드는 대부분 데이터 파일의 변경 없이 진행되며, 많은 경우 여러 버전을 건너뛰어서 업그레이드가 가능하다.  

하지만, 메이저 버전 간 업그레이드는 크고 작은 데이터 파일의 변경이 필요하기 때문에 반드시 직전 버전에서만 업그레이드가 허용된다. 예를 들어, MySQL 5.5 버전에서 5.6 버전으로는 업그레이드가 가느하지만, 5.6에서 곧 바로 5.7로 한 단계 건너뛰는 것은 불가능하다.  

만약, 두 단계 이상을 한 번에 업그레이드해야 한다면 mysqldump 프로그램으로 MySQL 서버에서 데이터를 백업받은 후 새로 구축된 MySQL 서버에 데이터를 적재하는 '논리적 업그레이드'가 나은 선택이 될 수 있다.  

<br/>

## MySQL 8.0 업그레이드 시 고려 사항

MySQL 5.7에서 MySQL 8.0으로 업그레이드하는 과정은 단순하지 않다. 대표적으로 MySQL 8.0 버전부터는 시스템 테이블의 정보와 데이터 딕셔너리 정보의 포맷이 완전히 바뀌었다.  

 - 데이터 딕셔너리 업그레이드: MySQL 8.0 버전부터 데이터 딕셔너리 정보가 트랜잭션이 지원되는 InnoDB 시스템 테이블로 저장된다. 데이터 딕셔너리 업그레이드는 기존의 FRM 파일의 내용을 InnoDB 시스템 테이블로 저장한다.
 - 서버 업그레이드: MySQL 서버의 시스템 데이터베이스의 테이블 구조를 MySQL 8.0 버전에 맞게 변경한다.

<br/>

 - `MySQL 8.0.15 버전 업그레이드`
    - MySQL 8.0.15 버전까지는 데이터 딕셔너리 업그레이드 작업은 MySQL 서버(mysqld) 프로그램이 실행하고 서버 업그레이드 작업은 mysql_upgrade 프로그램이 실행했다.
```
1. MySQL 셧다운
2. MySQL 5.7 프로그램 삭제
3. MySQL 8.0 프로그램 설치
4. MySQL 8.0 서버 시작
 - MySQL 서버가 데이터 딕셔너리 업그레이드를 자동 실행
5. mysql_upgrade 프로그램 실행
```

<br/>

 - `MySQL 8.0.16+ 버전 업그레이드`
    - MySQL 8.0.16부터는 mysql_upgrade 유틸리티가 없어지고, MySQL 서버 프로그램(mysql)이 시작되면서 모든 업그레이드 작업을 실행한다.
```
1. MySQL 셧다운
2. MySQL 5.7 프로그램 삭제
3. MySQL 8.0 프로그램 설치
4. MySQL 8.0 서버 시작
 - MySQL 서버가 데이터 딕셔너리 업그레이드 실행 후, 시스템 테이블 구조를 MySQL 8.0에 맞게 변환
```

