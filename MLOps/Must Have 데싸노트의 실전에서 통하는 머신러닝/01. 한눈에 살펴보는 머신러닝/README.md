## 01장. 한눈에 살펴보는 머신러닝

인공지능은 인간의 뇌를 모방하는 프로그램이다. 자율주행, 알파고, 쇼핑몰 추천 알고리즘 등 모두 인공지능에 해당한다.  
인공지능, 머신러닝, 딥러닝이라는 용어중에서 인공지능이 가장 큰 개념으로 사용된다.  

 - 인공지능: 인간의 뇌를 모방하는 모든 프로그램
 - 머신러닝: 데이터를 기반으로 학습해 무언가를 예측하거나, 데이터 자체의 어떤 특성을 찾아내는 프로그램
 - 딥러닝: 머신러닝 알고리즘 중 하나로, 인공 신경망에서 진화한 형태. 주로 이미지, 비디오, 자연어 분석에 사용
 - 인공지능 > 머신러닝 > 딥러닝

<br/>

### 머신러닝과 딥러닝

__머신러닝__ 은 기계학습으로 불리며 의미만 살펴볼 때 기계가 학습하는 것을 말한다.  
사람이 만든 분석 프로그램인 머신러닝 알고리즘에 입력값과 해당 정답값에 대한 결괏값을 입력하면, 입력값과 정답값 간의 관계를 찾아서 머신러닝 알고리즘이 새로운 프로그램(모델)을 만든다. 그후 새로운 프로그램에 데이터를 입력해서 값을 예측한다.  
즉, 머신러닝은 머신러닝 알고리즘으로 입력된 데이터 간의 관계를 밝혀내서 그 관계를 새로운 프로그램으로 만들어 새로운 데이터가 주어졌을 때 결과를 예측하는 일련의 과정이다.  

__딥러닝__ 은 심층 학습으로 불리며 인공 신경망을 기반으로 한 특수한 머신 러닝 기법으로, 빅데이터 기술과 하드웨어 발전, 새로운 알고리즘 등장으로 각광받게 되었다.  
딥러닝은 인간의 두뇌 작동 방식을 본떠 개발된 것으로 입력층과 출력층 사이에 은닉층을 두어 인간의 신경망처럼 작동시킨다.  
머신러닝 안에 딥러닝이 포함된다.  

<br/>

### 머신러닝 기법: 지도 학습, 비지도 학습, 강화 학습

머신러닝 기법에는 지도 학습, 비지도 학습, 강화 학습 3가지 범주가 존재한다.  

__지도 학습__ 은 입력값과 그에 대한 정답을 사용해 이 둘의 관계를 분석하고 예측 모델을 만들어낸다.  
목적에 따라서 지도 학습을 회귀 문제와 분류 문제로 구분할 수 있으며, __회귀 문제__ 는 예측 결과값이 연속성을 지니는 경우로 실수형으로 결과를 표현한다. __분류 문제__ 는 예측 결과값이 비연속적인 경우로 예/아니오처럼 답변을 얻게 된다.
 - 회귀: 연속된 값을 측정하는 문제. 매출액 예측, 부동산 가격 예측, 거래량 예측 등
 - 분류: 범주형 값을 측정하는 문제. 마케팅 문자를 보냈을 때 구매할 것 같은 고객을 예측하는 Yes/No 두가지 범주

<br/>

__비지도 학습__ 은 정답이 없는 데이터만으로 학습한다.  
애초에 정답이 제공되지 않아, 찾으려고 하는 답도 명확하지 않다.  
 - 군집화: 비슷한 데이터끼리 묶어주는 비지도 학습 방법. 소비 패턴이 유사한 카드 고객을 묶어주는 용도
 - 변환: 목적에 따라 데이터를 다른 형태로 변환하는 방법. 변수 100개의 특성을 최대한 살려 변수 2개로 압축하는 용도
 - 연관: 장바구니 분석이라고 불리며, 유사한 구매 목록을 가진 고객끼리 비교하여, 서로의 장바구니에 담기지 않은 새로운 아이템을 추천하는 목적 등으로 사용

<br/>

__강화 학습__ 은 행동에 대한 보상/처벌을 기반으로 하는 방법이다.  
보상을 받는 행동을 유도하고, 처벌을 받는 행동을 피하게끔 한다.  
유명한 강화 학습의 예시로는 알파고를 들 수 있다. 수를 잘 두면 보상을 하고, 잘못 두면 처벌하는 방법으로 학습하도록 한다.  

<br/>

### 머신러닝 프로세스

머신러닝은 주어진 문제를 푸는 일련의 과정을 통틀어 말한다.  
기본적으로 머신러닝 알고리즘으로 문제를 풀려면 데이터가 주어져야 하며, 주어진 데이터에 대해서 잘못된 데이터를 정리하는 데이터 전처리, 전처리된 데이터로 학습 모델을 만드는 모델학습 등 주어진 프로세스를 거쳐야 한다.  

```
1. 데이터 수집
데이터 수집은 머신러닝에 활용할 데이터를 수집하는 단계이다.

2. 데이터 전처리
수집된 데이터에 대해서 바로 사용할 수 있으면 좋겠지만, 보통은 잘못된 값이 들어있기 마련이다.
데이터 전처리는 이러한 부분을 수정 및 정리하고 기존 데이터들을 활용해 데이터를 추가로 만들어내는 과정이다.

3. 모델 학습
모델 학습은 준비된 데이터를 머신러닝 알고리즘에 반영해 학습시키는 과정이다.
하이퍼파라미터를 조절해 모델의 선응을 극대화시키는 과정도 포함된다.

4. 모델 평가
모델 평가는 학습이 완료된 모델을 사용해 예측해보고, 결과를 평가하는 단계이다.

5. 모델 배포
모델 배포는 머신러닝 결과물을 활용하는 단계이다.
예측 들어, 예측 모델을 배포해 서비스에 직/간접적으로 활용하거나, 예측 결과물을 대시보드 형태로 시각화해 공개하거나,
모델링을 통해 얻은 인사이트를 유관부서에 전달하는 방식이 될 수 있다.
```

<br/>

### 데이터 시각화 그래프 종류

데이터 시각화를 위해서 시본, 맥플롯립 라이브러리를 사용할 수 있다.  
시본을 이용해 그래프를 그리고, 그래프 크기나 폰트 등을 맷플롯립을 이용해 변경한다.  

 - `데이터 시각화 예시 코드`
    - 선형 그래프: 연속된 변수에 대한 특정 값의 변화를 나타내는 데 적합한 그래프. 보통 x축에 시간처럼 연속된 변수를 두고, 알고자 하는 변수를 y축에 표현한다.
    - 산점도: 두 변수 간의 전체적인 관계 및 그에 대한 분포를 표현하는 그래프. 각 데이터를 하나의 점으로 표현한다.
    - 히스토그램: 도수분포표를 나타내는 그래프. x축의 값은 실제로 연속된 값이나, 이를 일정 간격으로 나누어 각 구간에 대한 도수를 y축으로 표현한다.
    - 박스 플롯: 데이터의 대략적인 분포(25%, 50%, 75%지점)와 이상치 등을 간결하게 보여주는 그래프
    - 히트맵: 데이터를 색상으로 표현하는 그래프. 다른 그래프들과 달리 여러 변수를 동시에 반영할 수 없다. 여러 변수 간의 상관 관계를 그래프로 표현하는데 유용하다.
    - 막대 그래프: 히스토그램과 달리 특정 구간이 아닌 특정 범주에 대한 그래프를 그리는 그래프. 성별에 따라 다른 마케팅 반응률을 표현할 때 사용할 수 있다.
```python
import seaborn as sns
data = sns.load_dataset('tips')

# 선형 그래프
sns.lineplot(x = 'size', y = 'total_bill', data = data, hue = 'sex')

# 산점도
sns.scatterplot(x = 'tip', y = 'total_bill', data = data, hue = 'sex')

# 히스토그램
sns.histplot(data['size'])

# 박스 플롯
sns.boxplot(x = 'day', y = 'total_bill', data = data)

# 히트맵
sns.heatmap(data.corr())

# 막대 그래프
sns.barplot(x = 'day', y= 'total_bill', data = data)
```

<br/>

### 피처 엔지니어링 기법

피처 엔지니어링은 모델 학습에 입력할 데이터를 더 풍성하고 가치 있게 만드는 작업을 말한다.  
쓰레기 데이터가 들어가면 쓰레기 결과가나온다는 말이 있다. 즉, 데이터가 좋을수록 더 좋은 결과를 얻을 수도 있게 된다.  

때문에, 피처 엔지니어링은 머신러닝 프로세스에서 가장 중요한 과정으로 볼 수 있으며, 그만큼 많은 시간과 노력을 들여야 한다.  
 - 결측치 처리
    - 설명: 데이터가 누락된 부분을 평균, 특정값 등으로 채우는 기법
    - 사용처: 데이터 누락으로 인해 많은 데이터를 사용하지 못할 때
 - 아웃라이어 처리
    - 설명: 다른 데이터 무리들과는 크게 벗어나는 아웃라이어를 제거하거나 값을 조정해 튀는 데이터가 없도록 하는 기법
    - 사용처: 선형 모델과 같이 아웃라이어의 영향에 민감한 모델
 - 바이닝
    - 설명: 연속된 수치로 된 데이터를 특정 구간으로 묶는 기법
    - 사용처: 오버피팅으로 인해 모델 성능이 문제될 떄 (ex: 나이를 10대, 20대, 30대 등으로 묶는 경우)
 - 로그 변환
    - 설명: 데이터에 로그를 씌워 왜곡된 데이터를 정규화하는 방법
    - 사용처: 데이터 형태가 왜곡되어 변환이 필요한 경우.
 - 더미 변수
    - 설명: 문자로 된 범주형 데이터를 0과 1을 사용하는 숫자형 데이터 변경하는 기법
    - 사용처: 범주형 데이터
 - 스룹핑
    - 설명: 고윳값이 너무 많은 범주형 데이터를 특정 그룹으로 묶는 기법
    - 사용처: 범주형 데이터에서 고윳값이 너무 많아 더미 변수를 쓰기 곤란할 때 (ex: 국가명을 유럽, 아시아, 북아메리카 등으로 그룹화)
 - 스케일링
    - 설명: 각 변수의 데이터 범위가 다를 때, 이를 일정하게 맞춰주는 기법
    - 사용처: 거리 기반으로 작동하느 모델(K-최근접 이웃, K-평균 군집화)
 - 날짜 추출
    - 설명: 날짜 데이터에서 연/월/일 혹은 요일 등을 추출해 필요한 정보만 사용하는 기법
    - 사용처: 날짜 데이터의 특정 속성이 중요한 역할을 할 때
 - 텍스트 분할
    - 설명: 텍스트로 된 변수에서 특정 부분의 단어를 빼오거나, 특정 기호가 들어간 부분을 기준으로 나누어 필요한 항목만 추출하는 기법
    - 사용처: 텍스트 변수에 불필요한 정보가 많이 뒤섞여 있을 때
 - 새로운 변수 창출
    - 설명: 주어진 변수들을 사용해 새로운 변수를 계산해내는 기법
    - 사용처: 데이터에 대한 백그라운드 지식이 있을 때

<br/>

## 요약

 - 머신러닝은 지도 학습, 비지도 학습, 강화 학습으로 나뉜다.
 - 머신러닝 프로세스는 데이터 수집 > 데이터 전처리 > 모델 학습 > 모델 평가 > 모델 활용으로 이루어진다.
 - 피처 엔지니어링은 모델 학습에 입력할 데이터를 더 풍성하고 가치 있게 만드는 작업이다.
 - 독립 변수는 예측에 사용되는 재료와 같은 변수이다. 피처 변수 라고도 부른다.
 - 종속 변수는 예측을 하려는 대상 변수이며, 목표 변수라고도 한다.

