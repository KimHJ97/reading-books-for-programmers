# 02장. 물리 계층

컴퓨터는 모든 데이터를 0과 1 숫자만을 이용해 디지털로 표현한다. 이 2개의 숫자를 비트라고 부르며, 비트가 연속된 데이터를 '비트 열'이라고 부른다.  

물리 계층은 데이터링크 계층에서 전달받은 비트 열(프레임)을 케이블이나 전파에 보내는 아날로그 파로 변환하기 위한 규칙을 정의하고 있으며, 케이블의 소재나 커넥터의 형태, 핀 할당이나 무선 주파수 대역 등 네트워크에 관한 물리적인 모든 요소를 정의한다.  

일반적으로 물리 계층에서 사용되는 프로토콜은 유선 LAN의 기술을 표준화한 'IEEE802.3', 무선 LAN 기술을 표준화한 'IEEE802.11'로 나눌 수 있다.   

<br/>

## 유선 LAN(IEEE802.3)

IEEE802.3은 이더넷에 관한 기술을 표준화하고 있다.  
이더넷의 기원은 몇 개의 섬에 분산되어 존재하는 하와이 대학 캠퍼스를 무선으로 연결한 패킷 교환 타입의 네트워크인 ALOHAnet이다. ALOHAnet은 패킷이 전송되지 않으면 무작위 시간만큼 기다렸다가 다시 송신하는 구조를 채용하며, 이 구조가 바로 초기 이더넷의 기초가 되었다.  
1970년대 후반 ALOHAnet을 참조해 DEC, Intel, Xerox가 공동으로 이더넷을 개발하였으며, 이더넷은 저렴하게 고속화를 실현하고, 손쉽게 확장할 수 있어 폭발적으로 세계에 보급되었다.  
현재 가정이나 사무실 등 무선 LAN 네트워크 환경인 경우 대부분 이더넷을 이용한다.  

<br/>

### IEEE802.3 프로토콜

IEEE802.3은 전송 속도나 사용하는 케이블에 따라 다양한 프로토콜을 표준화하고 있으며, 각 IEEE802.3 뒤에 알파벳 한두 문자를 붙인 정식 명칭을 사용한다.  
 - 실무 현장에서는 보통 '@@BASE-XX'와 같이 프로토콜의 개요를 나타내는 별명을 사용한다.
    - @@에는 전송 속도
        - 10: 10Mbps
        - 100: 100Mbps
        - 1000: 1Gbps
        - 2.5G: 2.5Gbps
        - 10G: 10Gbps
    - XX에는 사용하는 전송 매체나 레이저의 종류가 들어간다.
        - T: 트위스트 페어 케이블
        - S: 단파장 레이저
        - L: 장파장 레이저
    - ex) LAN 케이블(twist pair cable)로 10Gps의 전송 속도를 구현하는 프로토콜 = IEEE802.3an = 10GBASE-T

<br/>

### 트위스트 페어 케이블

트위스트 페어 케이블은 겉으로 보기에는 하나의 케이블이지만, 실제로는 8가닥의 구리선을 2가닥씩(pair) 꼬아서(twisted) 하나로 묶은 케이블이다.  
트위스트 페어 케이블은 실드, 핀 할당, 카테고리로 분류할 수 있다.  

 - 실드에 따른 분류
    - 트위스트 페어 케이블은 실드 유무에 따라 UTP 케이블과 STP 케이블로 분류할 수 있다.
    - UTP 케이블
        - UTP 케이블은 소위 LAN 케이블을 의마한다.
        - 회사나 가정, 가전기기 판매점 등에서 쉽게 찾아볼 수 있으며, 다루기 쉽고, 가격도 저렴해 폭발적으로 보급되었다.
        - 전자석 노이즈에 약한 특성이 있어 공장 등 전자석 노이즈가 많은 환경에서는 적합하지 않다.
    - STP 케이블
        - 전자석 노이즈에 약한 UTP 케이블의 단점을 보완한 케이블이다.
        - 8가닥의 구리선을 알루미늄 포일이나 금속으로 감싸서 실드 처리를 해 전자 노이즈를 차단하고, 전기 신호의 감쇠나 산란을 방지한다.
 - 커넥터 핀 할당에 따른 분류
    - 트위스트 페어 케이블의 구리선은 파란색, 녹색, 주황색, 갈색으로 구분할 수 있으며, 구리선을 나열하는 순서에 따라 스트레이트 케이블과 크로스 케이블로 분류할 수 있다.
    - 스트레이트 케이블과 크로스 케이블은 10BASE-T나 100BASE-TX 사용시, 연결하는 물리 포트의 타입에 따라 구분해서 사용한다.
        - MDI 포트는 1번과 2번 핀을 송신, 3번과 6번 핀을 수신에 사용하며, PC나 서버의 NIC, 라우터나 방화벽, 부하 분산 장치의 물리 포트는 MDI 포트이다.
        - MDI-X 포트는 1번과 2번 핀을 수신, 3번과 6번 핀을 송신에 사용하며, L2 스위치와 L3 스위치의 물리 포트는 MDI-X 포트이다.
        - 연결할 때는 한쪽에서는 송신, 다른 한쪽에서 수신할 수 있도록 한다. 때문에, 다른 타입의 물리 포트끼리 연결할 때는 스트레이트 케이블을 사용한다. 같은 타입의 물리 포트끼리 연결할 때는 크로스 케이블을 사용한다.
 - 카테고리에 따른 분류
    - 카테고리는 전송 속도에 직접 관계가 있다. 카테고리 값이 클수록 전송 속도가 빠른 프로토콜에 대응할 수 있다.

<br/>

### 광섬유 케이블

단파장(Short wavelength) BASE-SC/SR, 장파장(Long wavelength) BASE-LX/LR 프롵콜은 광섬유 케이블을 사용하는 프로토콜이다.  
광섬유 케이블은 유리를 가느다란 관으로 만든 것으로 광 신호를 전송한다. 빛의 굴절률이 높은 코어와 굴절률이 비교적 낮은 클래딩의 2층으로 구성되어 있으며, 굴절률이 다른 유리를 2층 구조로 만들어 빛을 코어 안에 가둠으로써, 손실률이 낮은 빛의 전송로를 만든다.  

 - 케이블에 따른 분류
    - 광섬유 케이블에는 다중 모드 광섬유 케이블(MMF)과 단일 모드 광섬유 케이블(SMF) 2종류가 존재한다.
    - 다중 모드 광섬유 케이블
        - 코어 지름이 50ym 혹은 62.5ym의 광섬유 케이블
        - 10GBASE-SR이나 40GBASE-SR 등 단파장 빛을 사용하는 프로토콜에서 사용
        - 코어 지름이 크기 때문에 빛의 전송로가 여럿으로 분산된다.
    - 단일 모드 광섬유 케이블
        - 코어 지름이 8 ~ 10ym인 광섬유 케이블
        - 1000BASE-LX나 10GBASE-LR 등 장파장 빛을 사용하는 프로토콜에서 사용
        - 코어 지름을 작게하는 것과 코어와 클래딩의 굴절률 차를 적절하게 제어함으로써 빛의 전송로가 하나가 된다.
        - 전송로가 하나만 존재하도록 엄밀하게 설계되어 장거리 전송은 물론 대용량의 데이터 전송도 가능하다.
 - 커넥터에 따른 분류
    - 광섬유 케이블 커넥터는 여러 형태가 존재하지만, SC 커넥터, LC 커넥터, MPO 커넥터 3가지 종류를 많이 사용한다. (연결하는 기기나 트랜시버 모듈에 따라 커넥터 선택)
    - SC 커넥터
        - 플러그를 눌러 고정하고, 당기면 간단하게 빠지는 푸시-풀 구조의 커넥터
        - 다루기 쉽고 저렴하지만, 플러그가 다소 크다.
    - LC 커넥터
        - 트위스트 페어 케이블의 커넥터와 마찬가지로 플러그를 눌러 고정하고, 작은 돌기(래치)를 누르면서 당겨 뺀다.
        - SC 커넥터보다 플러그가 작아 더 많은 포트를 장치에 연결할 수 있다.
        - 10GBASE-SR/LR의 SFP+ 모듈이나 40GBASE-LR4의 QSFP+ 모듈 등과 연결할 때 사용
    - MPO 커넥터
        - 플러그를 눌러 고정하고, 당기면 간단하게 빠지는 푸시-풀 구조의 커넥터
        - 40GBASE-SR4의 QSFP+ 모듈이나 100GBASE-SR4의 QSFP28 모듈, 100GBASE-SR10의 CXP 모듈 등과 연결할 때 사용

<br/>

### 두 가지 통신 방식

인터넷의 통신 방식은 크게 반이중화 통신과 전이중화 통신 2가지로 나눈다.

 - `반이중화 통신`
    - 반이중화 통신은 송신할 때와 수신할 때, 그 해당 통신 방향을 전환해서 사용하는 방식이다. (1차선 양방향 도로)
    - 송신 중에는 수신할 수 없으며, 수신 중에는 송신할 수 없다. 만약, 우연히 양측이 같은 타이밍에 퍀킷을 송신하고, 송신 중에 패킷을 수신햇을 때는 '잼 신호' 라는 특수한 비트 패턴을 송신한다. 잼 신호를 받은 단말은 각각 무작위 시간 동안 기다린 뒤 패킷을 다시 보내기를 시도한다. (CSMA/CD 구조)
 - `전이중화 통신`
    - 전이중화 통신은 송신용 전송로와 수신용 전송로를 별도로 준비하고, 송신과 수신을 동시에 수행하는 방식이다. (왕복 2차선 도로)
    - 송수신을 동시에 수행할 수 있기 때문에 CSMA/CD 구조가 필요하지 않으며, 전송 속도를 최대한으로 높일 수 있다.
 - `오토 니고시에이션`
    - 오토 니고시에이션은 물리 포트에서 사용하는 프로토콜이나 통신 방식을 자동으로 식별하는 기능이다.
    - 오토 니고시에이션에 설정된 물리 포트는 연결과 동시에 FLP라는 특수한 신호 패턴을 사용해, 지원하는 프로토콜이나 통신 방식을 교환한다.

<br/>

## 무선 LAN(IEEE802.11)

IEEE802.11에는 무선 LAN 프로토콜이 표준화되었다.  
IEEE802.11 역시 IEEE802.3과 마찬가지로 각 프로토콜은 IEEE802.11 뒤에 알파벳을 추가해 이름을 붙이며 프로토콜에 따라 사용하는 주파수 대역, 변조 방식, 그리고 사용되는 기술이 다르다.  

<br/>

### 주파수 대역

무선 LAN에서 사용하는 주파수 대역은 2.4GHz 대역 또는 5.0GHz 대역 중 하나이다.  

 - `2.4GHz 대역`
    - 2.4GHz 대역은 ISM 밴드라 불리며 무선 LAN, 전자레인지, 블루투스, 아마추어 무선 등에서 사용되고 있다.
    - 전파 간섭이 발생하면 갑자기 연결이 끊어지거나 패킷이 소실되어 버릴 수 있다.
 - `5GHz 대역`
    - 5GHz 대역은 W52, W53, W56의 3개 주파수 대역으로 구성된다.
    - W52, W53은 20MHz씩 4개 채널, W56은 20MHz씩 11개 채널로 나뉘어져 있으며, 각 채널은 완전히 다른 파장을 사용하기 때문에 19개 채널을 모두 동시에 사용할 수 있다.
    - 옥외에서는 W56만 사용할 수 있다.
    - W53과 W56은 레이더파를 검출하면 채널을 변경하는 DFS 기능을 의무적으로 구현해야 한다.

<br/>

### 변조 방식

0과 1로 구성된 디지털 데이터를 아날로그 전파로 변환하는 것을 변조라고 부른다.  
무선 LAN은 1차 변조와 2차 변조의 2차례 변조함으로써 빠르고도 안정적으로 데이터를 보낼 수 있다.  
데이터를 전파로 보낼 수 있게 1차 변조하고, 전파가 노이즈에 강해지도록 2차 변조를 한다.  

 - `1차 변조`
    - 1차 변조는 일정 주파수로 된 기준 파형인 반송파와 디지털 데이터를 조합해 전파에 싣기 위한 변조파를 만든다.
    - 반송파에서 전파 진폭을 바꾸거나, 전파 각도를 어긋나게 해서 많은 0과 1을 보낼 수 있도록 한다.
    - 1차 변조 방식은 프로토콜의 전송 속도와 관계가 있다.
 - `2차 변조`
    - 2차 변조는 1차 변조로 만든 파형을 노이즈에 지지 않도록 하기 위한 변조이다.
    - 무선 LAN 프로토콜은 2차 변조 방식과 주파수 대역의 조합에 따라 정리할 수 있다.

<br/>

### 무선 LAN의 통신 방식

무선 LAN 단말은 송신과 수신에 같은 채널을 사용하므로 반이중화 통신으로 동작한다. 즉, 송수신을 동시에 할 수 없다.  
또한, 모두 같은 채널을 공유하기 때문에 여러 단말이 동시에 패킷을 송신할 수 없다.  

때문에, 무선 LAN은 충돌을 피하면서 통신하는 CSMA/CA 구조가 있다.  
CSMA/CA에 의해 동시에 패킷을 송신하는 단말은 반드시 1대이다. 하지만, 매우 빠르기 댸문에 모든 단말이 동시에 통신하는 것처럼 보이는 것이다.  

<br/>

### 고속화 기술

 - `숏 가드 인터벌`
    - 무선 LAN의 안테나로 들어오는 전파에는 전송 안테나로 직접 들어오는 직접파, 건물이나 벽을 반사하면서 시간차를 두고 도달하는 반사파가 있다.
    - 2종류의 전파가 어긋나거나 겹쳐서 파형이 어그러지는 다중 경로 간섭 현상이 발생하게 되며, 통신이 두절되거나 에러가 발생하게 된다.
    - 가드 인터벌은 이러한 다중 경로 간섭을 줄이는 기능을 말하며, 비트를 실은 전파의 가장 마지막 부분을 일정 시간 복사해서 전파 앞부분에 붙이는 기능이다.
 - `채널 본딩`
    - 채널 본딩은 인접한 채널을 동시에 사용함으로써 전송 속도를 향상하는 기술이다.
    - 채널 본딩을 사용하면 하나의 액세스 포인트가 여러 채널을 사용할 수 있다.
 - `MIMO`
    - 무선 LAN에서 공간을 흐르는 비트의 전송로를 공간 스트림이라 부른다.
    - 이 공간 스트림을 동시에 여럿 사용함으로써 전송 속도를 높이는 기술을 MIMO라 부른다.
 - `빔 포밍`
    - 스마트폰이나 PC 등 무선 LAN 단말에 핀 포인트로 전파를 보내는 기능을 빔 포밍이라 부른다.
    - 빔 포밍은 전파에 위상 제어를 통해 지향성을 만들고, 무선 LAN 단말에 대해 핀 포인트로 전파를 보낸다.
    - 전송 속도 향상과 전파 간섭 범위가 좁아져 통신 품질이 향상된다.

<br/>

### 기타 무선 프로토콜

 - `블루투스`
    - IEEE802.15.1로 표준화된 저전력형 근거리 무선 통신 프로토콜
    - 소비 전력이 적고 다양한 장치를 페어링해서 간단하게 연결할 수 있다.
    - 2.4GHz 대역을 79개 채널로 나누고, 1초에 1,600회 속도로 채널을 바꾸며 통신하는 FHSS 변조 방식을 채용하고 있다.
 - `지그비`
    - IEEE802.15.4에서 표준화된 저전력형 단거리 무선 프로토콜
    - 무선 LAN에 비해 전송 속도나 전송 거리면에서 압도적으로 열악하다.
    - 소비 전력이 적고, 슬립 시 대기 전력이 블루투스보다도 작아 스마트홈 가전이나 제조 공장의 센서 등 필요할 때만 통신하는 IoT에서 이용된다.
    - 2.4GHz 대역을 16개 채널로 나누고, 1차 변조에 QPSK, 2차 변조에 DSSS, 최대 250kbps의 전송 속도를 나타낸다.
